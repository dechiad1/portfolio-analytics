{"id":"portfolio-analytics-10i","title":"CreatePortfolioWithHoldingsCommand silently swallows exceptions","description":"In api/domain/commands/create_portfolio_with_holdings.py:169-170, a bare Exception catch logs errors to unmatched_descriptions instead of raising:\n\n```python\nexcept Exception as e:\n    unmatched_descriptions.append(f\"Failed to add {item.ticker}: {str(e)}\")\n```\n\nThis silently fails to create holdings without proper error visibility. Should either raise or log at warning level.","status":"open","priority":2,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:44:58.006973-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:44:58.006973-05:00"}
{"id":"portfolio-analytics-2lu","title":"Add unit tests for OAuthService","description":"api/domain/services/oauth_service.py (161 lines) has 0 test coverage.\n\nCritical OAuth flow logic needing tests:\n- generate_state_and_nonce() - CSRF and replay attack prevention\n- get_authorization_url() - OAuth provider integration\n- handle_callback() - token exchange, validation, user creation/update\n- _find_or_create_user() - user discovery, admin email detection, OAuth linking\n- _create_session_token() - JWT session token creation\n- verify_session_token() - session validation","status":"closed","priority":2,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.323494-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.477214-05:00","closed_at":"2026-01-28T08:13:42.477214-05:00","close_reason":"Closed"}
{"id":"portfolio-analytics-2v0","title":"Sanitize LLM input for portfolio dictation","description":"Dictionary input from LLM-based portfolio construction needs sanitization before use. This is a security concern - the LLM output is used to create holdings and should be validated/sanitized.\n\nReference: features/notes.md","status":"open","priority":2,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:31.873943-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:46:31.873943-05:00"}
{"id":"portfolio-analytics-3p2","title":"Add unit tests for HoldingService","description":"api/domain/services/holding_service.py (248 lines) has 0 test coverage.\n\nBusiness logic needing tests:\n- create_holding() - validation and creation\n- update_holding() - update with partial fields\n- delete_holding() - deletion with existence check\n- parse_and_create_holdings_from_csv() - CSV parsing and bulk creation\n- _parse_csv() - CSV parsing, header validation, date parsing, data validation\n- _validate_holding_data() - field validation, asset type validation\n- _parse_date() - ISO date parsing","status":"closed","priority":2,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.571875-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.436194-05:00","closed_at":"2026-01-28T08:13:42.436194-05:00","close_reason":"Closed"}
{"id":"portfolio-analytics-52o","title":"Fix race condition in AddHoldingModal debounced search","description":"In web/src/pages/portfolios/components/AddHoldingModal.tsx:39,53-84, the debounced search timeout could fire after component unmount:\n\n```typescript\ndebounceTimeout.current = setTimeout(async () =\u003e {\n  const results = await searchTickers(ticker, 10);\n  setSearchResults(results); // State update after unmount warning\n}, 300);\n```\n\nFix: Add AbortController for fetch cancellation on unmount.","status":"open","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:33.343135-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:46:33.343135-05:00"}
{"id":"portfolio-analytics-58v","title":"Add type hints to simulation_service security_params","description":"In api/domain/services/simulation_service.py:204, the parameter is weakly typed:\n\n```python\nsecurity_params: list  # Should be list[SecurityParams]\n```\n\nUpdate to use proper generic type hint for better IDE support and type checking.","status":"open","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.037907-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:46:32.037907-05:00"}
{"id":"portfolio-analytics-9ca","title":"Add unit tests for PortfolioService","description":"api/domain/services/portfolio_service.py (160 lines) has 0 test coverage.\n\nCore portfolio management logic needing tests:\n- create_portfolio() - portfolio creation\n- get_portfolio() - access control and retrieval\n- get_user_portfolios() - user-specific portfolio listing\n- get_all_portfolios_with_users() - admin vs user filtering\n- update_portfolio() - portfolio updates with permission checks\n- delete_portfolio() - cascading deletion\n- get_portfolio_holdings() - holdings retrieval with access control\n- get_portfolio_summary() - complex aggregation logic for percentages and gains","status":"closed","priority":2,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.450268-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.45621-05:00","closed_at":"2026-01-28T08:13:42.45621-05:00","close_reason":"Closed"}
{"id":"portfolio-analytics-awb","title":"Add unit tests for RiskAnalysisService","description":"api/domain/services/risk_analysis_service.py (108 lines) has 0 test coverage.\n\nFunctionality needing tests:\n- analyze_portfolio_risks() - portfolio access control, LLM integration\n- _calculate_summary() - complex financial calculations (gains/losses, percentages)\n- _holdings_to_dict() - holdings transformation with weight calculations\n\nNote: Depends on fixing the LLM null check bug first for proper test coverage.","status":"closed","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.688642-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.571141-05:00","closed_at":"2026-01-28T08:13:42.571141-05:00","close_reason":"Closed","dependencies":[{"issue_id":"portfolio-analytics-awb","depends_on_id":"portfolio-analytics-cc8","type":"blocks","created_at":"2026-01-25T21:47:03.247142-05:00","created_by":"Daniel DeChiara"}]}
{"id":"portfolio-analytics-cc8","title":"RiskAnalysisService crashes when LLM repository is None","description":"In api/domain/services/risk_analysis_service.py, the service calls self._llm_repo.analyze_portfolio_risks() without checking if _llm_repo is None. dependencies.py:268-269 can return None for the LLM repository. This causes AttributeError instead of graceful degradation.\n\nFix: Add null check before calling LLM methods, return appropriate response when LLM unavailable.","status":"closed","priority":1,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:31.721734-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-26T09:50:10.568082-05:00","closed_at":"2026-01-26T09:50:10.568082-05:00","close_reason":"Closed"}
{"id":"portfolio-analytics-dfn","title":"Add frontend component and hook tests","description":"web/src/ has 0 component or hook tests (40+ files). Only E2E tests exist.\n\nPriority components needing tests:\n- AuthContext.tsx - Auth provider with useAuth hook\n- usePortfolioListState/usePortfolioDetailState - State management hooks\n- useSpeechRecognition - Speech API integration (200 lines)\n- AddHoldingModal, EditHoldingModal - Form validation\n- SimulationConfigModal - Parameter validation\n- API client modules (client.ts, portfolioApi.ts, etc.)\n\nShould use vitest + react-testing-library.","status":"open","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:33.207613-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:46:33.207613-05:00"}
{"id":"portfolio-analytics-g4y","title":"SimulationService uses synthetic data without logging","description":"In api/domain/services/simulation_service.py:265-266, when historical returns are missing, the service falls back to random data:\n\n```python\nelse:\n    returns_matrix.append(np.random.randn(252) * 0.01)\n```\n\nNo logging occurs - this is a silent data integrity issue. Should log a warning when using synthetic fallback data.","status":"open","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:44:58.133751-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:44:58.133751-05:00"}
{"id":"portfolio-analytics-hi8","title":"Add unit tests for CreatePortfolioWithHoldingsCommand","description":"api/domain/commands/create_portfolio_with_holdings.py (239 lines) has 0 test coverage.\n\nTransaction and multi-step logic needing tests:\n- execute() - portfolio + holdings creation in transaction\n- _create_holding_in_transaction() - security creation, position creation\n- map_sector_to_asset_class() - sector to asset class mapping (65 mappings)","status":"closed","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:33.080194-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.515553-05:00","closed_at":"2026-01-28T08:13:42.515553-05:00","close_reason":"Closed"}
{"id":"portfolio-analytics-irk","title":"Add unit tests for TickerService","description":"api/domain/services/ticker_service.py (51 lines) has 0 test coverage.\n\nFunctionality needing tests:\n- add_ticker() - ticker validation, duplicate detection, persistence\n- get_user_added_tickers() - filtering and retrieval","status":"closed","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.806109-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.552062-05:00","closed_at":"2026-01-28T08:13:42.552062-05:00","close_reason":"Closed"}
{"id":"portfolio-analytics-kz5","title":"Add unit tests for ComputeAnalyticsCommand","description":"api/domain/commands/compute_analytics.py (243 lines) has 0 test coverage.\n\nComplex analytics calculation logic needing tests:\n- execute() - empty portfolio handling, aggregation\n- _build_ticker_analytics() - analytics building with fallback handling\n- _compute_portfolio_metrics() - averaging logic\n- _compute_asset_class_breakdown() - grouping and averaging\n- _compute_sector_breakdown() - grouping and averaging","status":"closed","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.941073-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.533784-05:00","closed_at":"2026-01-28T08:13:42.533784-05:00","close_reason":"Closed"}
{"id":"portfolio-analytics-pcs","title":"Add persistence for risk analysis results","description":"Risk analysis results are computed but not saved to the database. Users cannot view historical risk analyses.\n\nReference: features/notes.md\n\nShould add a risk_analysis table and repository to persist results, similar to how simulations are saved.","status":"open","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:33.645441-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:46:33.645441-05:00","dependencies":[{"issue_id":"portfolio-analytics-pcs","depends_on_id":"portfolio-analytics-cc8","type":"blocks","created_at":"2026-01-25T21:47:03.396085-05:00","created_by":"Daniel DeChiara"}]}
{"id":"portfolio-analytics-uda","title":"Replace hardcoded prices with market prices in portfolio builder","description":"Portfolio builder uses hardcoded prices for allocations instead of fetching actual market prices.\n\nReference: features/notes.md\n\nShould fetch current prices from the price data pipeline when building portfolio allocations.","status":"open","priority":3,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:33.466891-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:46:33.466891-05:00"}
{"id":"portfolio-analytics-uis","title":"Replace string-based exception matching with domain exceptions","description":"Several routers use brittle string matching for error classification:\n\n- api/routers/portfolios.py:548-562 - matches 'not found' and 'Access denied' in str(e)\n- api/routers/simulations.py:152-177 - similar pattern\n\nThis breaks if error messages change. Should use specific domain exceptions (PortfolioNotFoundError, PortfolioAccessDeniedError) consistently like other routers do.","status":"open","priority":2,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:44:50.588509-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-25T21:44:50.588509-05:00"}
{"id":"portfolio-analytics-vsw","title":"Add unit tests for AuthService","description":"api/domain/services/auth_service.py (124 lines) has 0 test coverage.\n\nCritical functionality needing tests:\n- register() - user creation, email validation, password hashing\n- login() - authentication flow, password verification\n- verify_token() - JWT token validation, expiration handling, invalid tokens\n- _hash_password() - PBKDF2 hashing with salt\n- _verify_password() - password comparison with timing-safe comparison\n- _create_token() - JWT token generation with expiry","status":"closed","priority":2,"issue_type":"task","owner":"dechiada@gmail.com","created_at":"2026-01-25T21:46:32.178726-05:00","created_by":"Daniel DeChiara","updated_at":"2026-01-28T08:13:42.49553-05:00","closed_at":"2026-01-28T08:13:42.49553-05:00","close_reason":"Closed"}
