{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2025-11-15T14:19:53.645123Z", "invocation_id": "22b1e30e-8e47-4a7b-a591-0c491b5aeffd", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T14:19:53.583017Z", "completed_at": "2025-11-15T14:19:53.585827Z"}, {"name": "execute", "started_at": "2025-11-15T14:19:53.586085Z", "completed_at": "2025-11-15T14:19:53.610795Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029546022415161133, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.portfolio_analytics.stg_fund_metadata", "compiled": true, "compiled_code": "-- Staging model: Clean and standardize fund metadata\n\nwith source as (\n    select * from \"portfolio\".\"main\".\"raw_fund_metadata\"\n),\n\ncleaned as (\n    select\n        ticker,\n        fund_name,\n\n        -- Convert expense ratio to percentage for easier reading\n        -- yfinance returns as decimal (e.g., 0.0003 = 0.03%)\n        case\n            when expense_ratio is not null\n            then round(expense_ratio * 100, 4)  -- Convert to percentage (0.03%)\n            else null\n        end as expense_ratio_pct,\n\n        fund_family,\n        category,\n        fund_inception_date,\n        total_assets,\n        currency,\n        exchange,\n        quote_type,\n        long_business_summary as mandate,\n        asset_distribution,\n        top_sectors\n\n    from source\n)\n\nselect * from cleaned", "relation_name": "\"portfolio\".\"main_staging\".\"stg_fund_metadata\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T14:19:53.613694Z", "completed_at": "2025-11-15T14:19:53.614970Z"}, {"name": "execute", "started_at": "2025-11-15T14:19:53.615219Z", "completed_at": "2025-11-15T14:19:53.635685Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02685689926147461, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.portfolio_analytics.dim_funds", "compiled": true, "compiled_code": "-- Marts model: Comprehensive fund dimension with metadata and performance\n\n\n\nwith fund_metadata as (\n    select * from \"portfolio\".\"main_staging\".\"stg_fund_metadata\"\n),\n\nperformance as (\n    select * from \"portfolio\".\"main_marts\".\"fct_performance\"\n),\n\nholdings as (\n    select * from \"portfolio\".\"main_staging\".\"stg_holdings\"\n),\n\ncombined as (\n    select\n        -- Fund identifiers\n        fm.ticker,\n        fm.fund_name,\n\n        -- Fund metadata\n        fm.expense_ratio_pct,\n        fm.fund_family,\n        fm.category,\n        fm.fund_inception_date,\n        fm.total_assets,\n        fm.currency,\n        fm.exchange,\n        fm.quote_type,\n        fm.mandate,\n        fm.asset_distribution,\n        fm.top_sectors,\n\n        -- Legacy holdings data (from old seed)\n        h.name as holdings_name,\n        h.asset_class,\n        h.sector,\n        h.broker,\n        h.purchase_date,\n\n        -- Performance metrics\n        p.first_date as performance_start_date,\n        p.last_date as performance_end_date,\n        p.starting_price,\n        p.ending_price,\n        p.min_price,\n        p.max_price,\n        p.total_return_pct,\n        p.annualized_return_pct,\n        p.volatility_pct,\n        p.sharpe_ratio,\n        p.benchmark_total_return,\n        p.vs_benchmark_pct,\n        p.trading_days,\n        p.months_tracked,\n        p.avg_risk_free_rate,\n\n        -- Data quality flags\n        case when fm.expense_ratio_pct is not null then 1 else 0 end as has_expense_ratio,\n        case when fm.mandate is not null then 1 else 0 end as has_mandate,\n        case when fm.asset_distribution is not null then 1 else 0 end as has_asset_distribution,\n        case when p.ticker is not null then 1 else 0 end as has_performance_data\n\n    from fund_metadata fm\n    left join holdings h on fm.ticker = h.ticker\n    left join performance p on fm.ticker = p.ticker\n)\n\nselect * from combined", "relation_name": "\"portfolio\".\"main_marts\".\"dim_funds\""}], "elapsed_time": 0.11661171913146973, "args": {"static_parser": true, "favor_state": false, "log_path": "/Users/dechiada/Documents/code/portfolio-analytics/portfolio_analytics/dbt/logs", "log_level": "info", "exclude": [], "printer_width": 80, "strict_mode": false, "macro_debugging": false, "enable_legacy_logger": false, "quiet": false, "invocation_command": "dbt run --select stg_fund_metadata dim_funds", "write_json": true, "log_format": "default", "use_colors": true, "show_resource_report": false, "cache_selected_only": false, "partial_parse": true, "use_colors_file": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "vars": {}, "which": "run", "populate_cache": true, "project_dir": "/Users/dechiada/Documents/code/portfolio-analytics/portfolio_analytics/dbt", "introspect": true, "log_file_max_bytes": 10485760, "profiles_dir": "/Users/dechiada/Documents/code/portfolio-analytics/portfolio_analytics/dbt", "select": ["stg_fund_metadata", "dim_funds"], "defer": false, "indirect_selection": "eager", "version_check": true, "log_format_file": "debug"}}